(function(e,i){typeof exports=="object"&&typeof module<"u"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(e=typeof globalThis<"u"?globalThis:e||self,i(e["bentools-picker"]={}))})(this,function(e){"use strict";var a=Object.defineProperty;var u=(e,i,r)=>i in e?a(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r;var g=(e,i,r)=>u(e,typeof i!="symbol"?i+"":i,r);class i extends Error{constructor(){super("Cannot pick from an empty list"),this.name="EmptyPickerError"}}function r(c){return typeof c=="object"&&c!==null}class l{constructor(t,s){g(this,"items");g(this,"options");g(this,"weights");this.items=[...t],this.options=s;const o=t.length>0&&r(t[0]);if(this.weights=o?new WeakMap:new Map,s.weights){if(Array.isArray(s.weights))for(const[h,n]of s.weights)o&&r(h)?this.weights.set(h,n):o||this.weights.set(h,n);else if(!o){const h=s.weights;for(const n of t){const f=String(n);f in h&&this.weights.set(n,h[f])}}}}getWeight(t){return r(t)?this.weights.get(t)??this.options.defaultWeight:this.weights.get(t)??this.options.defaultWeight}setWeight(t,s){return r(t)?this.weights.set(t,s):this.weights.set(t,s),this}calculateTotalWeight(){return this.items.reduce((t,s)=>t+this.getWeight(s),0)}pick(){if(this.items.length===0){if(this.options.errorIfEmpty)throw new i;return}const t=this.calculateTotalWeight();let s=Math.random()*t;for(let h=0;h<this.items.length;h++){const n=this.items[h],f=this.getWeight(n);if(s<=f)return this.options.shift&&this.items.splice(h,1),n;s-=f}const o=this.items[this.items.length-1];return this.options.shift&&this.items.pop(),o}}e.EmptyPickerError=i,e.Picker=l,e.isWeakKeyable=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
